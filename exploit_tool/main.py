#!/usr/bin/env python3

import argparse
import sys

from exploit_tool.shell import InteractiveShell
from exploit_tool.theme import Theme

def main():
    parser = argparse.ArgumentParser(
        description='CVE-2025-55182 Interactive Exploitation Shell',
        formatter_class=argparse.RawDescriptionHelpFormatter,
        epilog="""
Examples:
  %(prog)s -t http://localhost:3000
  %(prog)s -t vulnerable-site.com
        """
    )
    
    parser.add_argument('-t', '--target', 
                       required=True,
                       metavar='URL',
                       help='Target URL or domain')
    parser.add_argument('-T', '--timeout',
                       type=int,
                       default=15,
                       metavar='SECONDS',
                       help='Request timeout in seconds (default: 15)')
    
    args = parser.parse_args()
    
    shell = InteractiveShell(args.target)
    shell.config.timeout = args.timeout
    shell.run()

if __name__ == "__main__":
    try:
        main()
    except KeyboardInterrupt:
        print(f"\n\n{Theme.WARNING}[!] Shell interrupted{Theme.ENDC}\n")
        sys.exit(130)
    except Exception as e:
        print(f"\n{Theme.FAIL}[!] Fatal error: {e}{Theme.ENDC}\n")
        sys.exit(1)

